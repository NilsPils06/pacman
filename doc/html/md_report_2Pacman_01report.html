<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pacman Project: Pacman Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Pacman Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_report_2Pacman_01report.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Pacman Project </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md7"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
by Nils Van de Velde 20240345</h1>
<p>Our main function creates a <a class="el" href="classGame.html">Game</a> object and starts the game loop by running the render function. In our <a class="el" href="classGame.html">Game</a> class you can find 4 static variables which are used throughout the project. Some of these are made inline to prevent undefined reference errors. The window which is used by almost every <a class="el" href="classState.html">State</a> is static for easy access, so that not every <a class="el" href="classState.html">State</a> contains a copy or pointer to the window. Fonts and the spritesheet are made static so that we only have to initialize them once and from then on we can use them wherever we want. As previously stated the render function contains the game loop which does the following:</p>
<p>1) Check if the window is still open. <br  />
 2) Update the <a class="el" href="classStopwatch.html">Stopwatch</a> and check for SFML Events. <br  />
 3) Clear the screen and render the current <a class="el" href="classState.html">State</a>.</p>
<p>The <a class="el" href="classStateManager.html">StateManager</a> uses a stack of States to manage them. Through the <a class="el" href="classStateManager.html">StateManager</a> we can directly call the update and render functions of the States. Every <a class="el" href="classState.html">State</a> has 1-3 update functions and the <a class="el" href="classStateManager.html">StateManager</a> decides which update to call. This way a <a class="el" href="classState.html">State</a> doesn’t have one giant update function and we can clearly separate key, mouse and text input without the manager needing a bunch of different functions. Every <a class="el" href="classState.html">State</a> handles its own rendering and is able to do this via the render function and the public static window member inside <a class="el" href="Game_8h_source.html">Game.h</a>. I could’ve made it so that <a class="el" href="classGame.html">Game</a> and <a class="el" href="classCamera.html">Camera</a> are the only owners of the window, but then <a class="el" href="classCamera.html">Camera</a> had to handle the rendering of States, which is a bit complicated for <a class="el" href="classMenuState.html">MenuState</a> thanks to the scoreboard. I wanted the <a class="el" href="classCamera.html">Camera</a> to handle the rendering of the actual game elements namely: entities, current score and current amount of lives. Since the window is a public static variable inside <a class="el" href="Game_8h_source.html">Game.h</a>, <a class="el" href="classCamera.html">Camera</a> doesn’t have its own member variables, so making it a Singleton is in this case not optimal. Because we don’t need a <a class="el" href="classCamera.html">Camera</a> object/instance, <a class="el" href="classCamera.html">Camera</a> only contains static functions, which are called where needed.</p>
<p>When we are in the <a class="el" href="classMenuState.html">MenuState</a> there are 2 ways to start the game. First you need to type in a name for the scoreboard, but after that you can either press the play button or press enter, which I feel is more user-friendly than only having the play button. Having names by the top 5 scores is also a pretty fun addition, since you can see who gained the highest score. I added a Victory and Defeat <a class="el" href="classState.html">State</a> to have a pause in between two levels and to prevent the render function of <a class="el" href="classLevelState.html">LevelState</a> from becoming too big. It is possible to put the victory and defeat screen inside <a class="el" href="classLevelState.html">LevelState</a>, but this would overcomplicate it. LevelState’s render function is the only render function of a <a class="el" href="classState.html">State</a> that does something else than just rendering. It also calls the <a class="el" href="classWorld.html">World</a> tick function. The world is created inside LevelState’s constructor and a new <a class="el" href="classWorld.html">World</a> is created when you complete a level, while the old one is removed. The world uses the <a class="el" href="classEntityFactory.html">EntityFactory</a> to create entities and we give <a class="el" href="classWorld.html">World</a> the current level so that it can set the Ghosts difficulty. The <a class="el" href="classEntityFactory.html">EntityFactory</a> creates both a model and view of all entities, except Wall, Coin and Fruit. These 3 have no animations and only use a static image, so they are handled via a base EntityView object. The factory also contains a stack of all “ghost types”, so that the ghosts always have the same logic, color and wait time combination. The last thing the factory does is give the Views the correct sprite(s).</p>
<p>I implemented my own <a class="el" href="classEvent.html">Event</a> system for easier communication between <a class="el" href="classObserver.html">Observer</a> and Subject. It is a pretty robust system that isn’t optimally used but can be further expanded on and used differently with different representation code. Subjects or EntityModels use the notify(event) function in two ways. It handles events that have an effect on logic, such as <a class="el" href="classDirectionChangeEvent.html">DirectionChangeEvent</a> for Pacman, and it can notify an <a class="el" href="classObserver.html">Observer</a> of the event. The Events contains almost all the information needed to handle it, such as direction and facing in <a class="el" href="classTickEvent.html">TickEvent</a>, so that the <a class="el" href="classObserver.html">Observer</a> and Subject can properly handle it.</p>
<p>The <a class="el" href="classWorld.html">World</a> contains 3 separate vectors for the entities, to better separate logic, and a PacmanCollsionHandler. The walls vector is used for the isWalkable function and for rendering, which is done via tick and the notification of a <a class="el" href="classRenderStaticEvent.html">RenderStaticEvent</a>. The ghosts vector is used for collision with ghosts, to give them the different functions they need and to reset their position when Pacman loses a life. Lastly the collectables vector is used to check for the amount of collectables, collisions and to check for expiration. I decided to mark collectables as expired when eaten so that they are removed from memory, which makes the game more memory efficient. The <a class="el" href="classPacmanCollisionHandler.html">PacmanCollisionHandler</a> contains Pacman, so that its tick function can be called. I have a different CollisionHandler for Pacman to prevent the Pacman model from being overcomplicated and having too many tasks.</p>
<p>The ghosts are given functions which give them access to Pacman’s position, the location of walls and a gridmap. Since I use BFS for Ghost AI, I gave them a gridMap to be able to implement it better. Either way a game like Pacman works better with grid coordinates. I decided to use BFS, because I was irritated by the fact that Ghosts often walked against walls to try and get through it and so that I could easily make the return to their spawn. The movement code in general is split into multiple functions for better organization and to make things like target manipulation easier.</p>
<p>In the file <a class="el" href="Util_8h_source.html">Util.h</a> I have some utility enums and structs like <a class="el" href="structCoords.html">Coords</a> for coordinates. <a class="el" href="structCoords.html">Coords</a> also contain height and width for a hitbox, even though in my project every entity's hitbox is the same. These are also used to calculate a cell size for the projection with the <a class="el" href="classCamera.html">Camera</a>.</p>
<p>I also made a separate <a class="el" href="classAnimatedView.html">AnimatedView</a> class to better generalize the animation code for animated entities. Lastly I implemented a map system using text files for easy reading and writing, which is also why I use a json file for score, and the game works best in a 16:9 aspect ratio, rescaling messes with game logic and will create a difference in horizontal and vertical speed. I especially recommend running it at 1080p or 1440p, which is the resolution of the monitor I mainly tested on. There are improvements that could still be made, but I personally think I’ve crossed many boundaries for myself, I improved a lot making this project and it turned out pretty well.</p>
<p>More/other information can be found in the project README and for more information on the map system you can find a separate README inside the maps folder. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
